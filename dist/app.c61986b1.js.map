{"version":3,"sources":["app.ts"],"names":[],"mappings":"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","file":"app.c61986b1.js","sourceRoot":"..","sourcesContent":["\r\n// type alias\r\n\r\ntype NewsFeed = {\r\n  id: number,\r\n  title: string,\r\n  comments_count: number,\r\n  url: string,\r\n  user: string,\r\n  points: number,\r\n  time_ago: string,\r\n  read?: boolean\r\n}\r\n\r\ntype Store = {\r\n  newsFeed: NewsFeed[],\r\n  currentPage: number,\r\n  lastPage: number,\r\n  pageSize: number\r\n}\r\n\r\nconst root : HTMLElement | null = document.getElementById(\"root\")\r\nconst ajax : XMLHttpRequest = new XMLHttpRequest\r\nconst newsUrl : string = `https://api.hnpwa.com/v0/news/1.json`\r\nconst contentUrl : string = `https://api.hnpwa.com/v0/item/@id.json`\r\n\r\nconst store : Store = { currentPage: 1, pageSize: 5, newsFeed: [], lastPage: 1 }\r\n//---------------------------------------------------\r\n\r\n\r\nconst getData = (url :string) => {\r\n  ajax.open(\"GET\", url, false)\r\n  ajax.send()\r\n  return JSON.parse(ajax.response)\r\n}\r\n\r\nconst initReadState = (feeds) => {\r\n  let i = 0\r\n  for (i = 0; i < feeds.length; i++) {\r\n    feeds[i].read = false\r\n  }\r\n  return feeds\r\n}\r\n\r\nconst updateView = (html:string) => {\r\n  if (root) {\r\n    root.innerHTML = html\r\n  } else {\r\n    console.error(\"root element not found\")\r\n  }\r\n}\r\n\r\nconst newsFeed = () => {\r\n  let news :NewsFeed[] = store.newsFeed\r\n\r\n  if (news.length == 0) {\r\n    news = store.newsFeed = initReadState(getData(newsUrl))\r\n    store.lastPage = Math.ceil(news.length / store.pageSize)\r\n  }\r\n\r\n  const newsList = []\r\n  let template = `\r\n    <div class=\"bg-gray-600 min-h-screen\">\r\n      <div class=\"bg-white text-xl\">\r\n        <div class=\"mx-auto px-4\">\r\n          <div class=\"flex justify-between items-center py-6\">\r\n            <div class=\"flex justify-start\">\r\n              <h1 class=\"font-extrabold\">Hacker News</h1>\r\n            </div>\r\n            <div class=\"items-center justify-end\">\r\n              <a href=\"#/page/@prev\" class=\"text-gray-500\">\r\n                Previous\r\n              </a>\r\n              <a href=\"#/page/@next\" class=\"text-gray-500 ml-4\">\r\n                Next\r\n              </a>\r\n            </div>\r\n          </div> \r\n        </div>\r\n      </div>\r\n      <div class=\"p-4 text-2xl text-gray-700\">\r\n        @news       \r\n      </div>\r\n    </div>\r\n  `\r\n\r\n  for (let i = (store.currentPage - 1) * store.pageSize; i < (store.currentPage) * store.pageSize; i++) {\r\n    const { id, title, comments_count, user, points, time_ago, read } = news[i]\r\n    newsList.push(`\r\n      <div class=\"read p-6 ${read ? 'bg-gray-500' : 'bg-white'} mt-6 rounded-lg shadow-md transition-colors duration-500 hover:bg-green-100\">\r\n        <div class=\"flex\">\r\n          <div class=\"flex-auto\">\r\n            <a href=\"#/show/${id}\">${title}</a>  \r\n          </div>\r\n          <div class=\"text-center text-sm\">\r\n            <div class=\"w-10 text-white bg-green-300 rounded-lg px-0 py-2\">${comments_count}</div>\r\n          </div>\r\n        </div>\r\n        <div class=\"flex mt-3\">\r\n          <div class=\"grid grid-cols-3 text-sm text-gray-500\">\r\n            <div><i class=\"fas fa-user mr-1\"></i>${user}</div>\r\n            <div><i class=\"fas fa-heart mr-1\"></i>${points}</div>\r\n            <div><i class=\"far fa-clock mr-1\"></i>${time_ago}</div>\r\n          </div>  \r\n        </div>\r\n      </div>    \r\n    `)\r\n  }\r\n\r\n  template = template.replace('@news', newsList.join(''))\r\n  template = template.replace('@prev', store.currentPage > 1 ? store.currentPage - 1 : 1)\r\n  template = template.replace('@next', store.currentPage < store.lastPage ? store.currentPage + 1 : store.lastPage)\r\n  \r\n  updateView(template)\r\n}\r\n\r\nconst newsContent = () => {\r\n  const id = location.hash.slice(7)\r\n  store.newsFeed.map(news => {\r\n    if (news.id == Number(id)) {\r\n      news.read = true\r\n    }\r\n  })\r\n\r\n  const { title, content, comments } = getData(contentUrl.replace(\"@id\", id))\r\n  let template = `\r\n    <div class=\"bg-gray-600 min-h-screen pb-8\">\r\n      <div class=\"bg-white text-xl\">\r\n        <div class=\"mx-auto px-4\">\r\n          <div class=\"flex justify-between items-center py-6\">\r\n            <div class=\"flex justify-start\">\r\n              <a href=\"#/page/${store.currentPage}\" class=\"font-extrabold\">Hacker News</a>\r\n            </div>\r\n            <div class=\"items-center justify-end\">\r\n              <a href=\"#/page/${store.currentPage}\" class=\"text-gray-500\">\r\n                <i class=\"fa fa-times\"></i>\r\n              </a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"h-full border rounded-xl bg-white m-6 p-4 \">\r\n        <h2>${title}</h2>\r\n        <div class=\"text-gray-400 h-20\">\r\n          ${content}\r\n        </div>\r\n        @comments\r\n      </div>\r\n    </div>\r\n  `\r\n  const makeComment = (comments) => {\r\n    const commentStr = []\r\n\r\n    for (let i = 0; i < comments.length; i++) {\r\n      const { user, content, time_ago, level } = comments[i]\r\n      commentStr.push(`\r\n        <div style=\"padding-left: ${level * 20}px;\" class=\"mt-4\">\r\n          <div class=\"text-gray-400\">\r\n            <i class=\"fa fa-sort-up mr-2\"></i>\r\n            <strong>${user}</strong> ${time_ago}\r\n          </div>\r\n          <p class=\"text-gray-700\">${content}</p>\r\n        </div>\r\n      `)\r\n\r\n      if (comments[i].comments) {\r\n        // 재귀함수를 통해 대댓글을 만들어준다.\r\n        commentStr.push(makeComment(comments[i].comments))\r\n      }\r\n    }\r\n\r\n    return commentStr.join('')\r\n  }\r\n\r\n  updateView(template.replace('@comments', makeComment(comments)))\r\n}\r\n\r\nconst router = () => {\r\n  const routePath = location.hash\r\n  if (routePath == '' || routePath == '#') {\r\n    newsFeed()\r\n  } else if (routePath.startsWith('#/page/')) {\r\n    store.currentPage = Number(routePath.slice(7))\r\n    newsFeed()\r\n  } else if (routePath.startsWith('#/show/')) {\r\n    newsContent()\r\n  }\r\n}\r\n\r\nnewsFeed()\r\nwindow.addEventListener(\"hashchange\", router)"]}